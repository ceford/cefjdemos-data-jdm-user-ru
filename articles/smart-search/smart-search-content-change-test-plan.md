<!-- Filename: Smart_Search_content_change_test_plan / Display title: План тестирования умного поиска -->

Ниже представлен примерный план тестирования, охватывающий (в основном) обновление индекса умного поиска при различных обновлениях контента.

Умный поиск необходимо протестировать для каждого из поддерживаемых основных типов контента. К ним относятся:

- Статьи
- Категории
- Контакты
- Ленты новостей
- Веб-ссылки

Для каждого из вышеперечисленных типов контента нам нужно протестировать следующее:

## Изменения текста

Изменение различных текстовых полей в содержимом элемента должно изменять поисковые термины в индексе (за исключением одного примечательного случая, описанного ниже). Нет необходимости тестировать все текстовые поля для данного типа содержимого, так как если это работает для одного, это будет работать для всех, поэтому выберите одно для каждого типа содержимого. Следующие текстовые поля индексируются для основных компонентов:

- Статьи
  - Заголовок
  - Псевдоним
  - Текст статьи
  - Описание метаданных
  - Ключевые слова метаданных
  - Автор метаданных
  - Автор
  - Создано псевдонимом
- Категории
  - Заголовок
  - Псевдоним
  - Описание
  - Ссылка ??? (не уверен, что существует такое поле)
  - Описание метаданных
  - Ключевые слова метаданных
  - Автор метаданных
  - Автор
- Контакты
  - Имя
  - Псевдоним
  - Связанные имя пользователя
  - Другая информация
  - Должность (если включено в Опциях)
  - Адрес (если включено в Опциях)
  - Город (если включено в Опциях)
  - Регион (если включено в Опциях)
  - Страна (если включено в Опциях)
  - Индекс (если включено в Опциях)
  - Телефон (если включено в Опциях)
  - Факс (если включено в Опциях)
  - Электронная почта (если включено в Опциях)
  - Мобильный (если включено в Опциях)
  - Веб-страница (если включено в Опциях)
- Новостные ленты
  - Заголовок
  - Псевдоним
  - Ссылка
  - Описание метаданных
  - Ключевые слова метаданных
  - Автор метаданных
  - Автор
  - Создано псевдонимом
- Веб-ссылки
  - Заголовок
  - Псевдоним
  - URL
  - Описание
  - Описание метаданных
  - Ключевые слова метаданных
  - Автор метаданных
  - Автор
  - Создано псевдонимом

Для тестирования просто добавьте какую-то случайную строку, например "xyz", в кусок обычного текста и ближе к началу, затем попробуйте найти этот термин на фронтальной части сайта.

- ваша случайная строка должна появиться в списке автозаполнителя при ее вводе.
- ваша случайная строка должна появиться 3 раза в списке автозаполнителя.
  - отдельно
  - вместе со следующим словом после нее
  - вместе со следующим двумя словами после нее
- элемент содержимого, содержащий вашу случайную строку, должен появиться в списке результатов поиска.
- ваша случайная строка должна быть выделена в результатах поиска, при условии, что вы ввели ее ближе к началу текста (потому что текст в результатах поиска усечен).

Удалите вашу случайную строку из текста: это должно удалить 3 поисковых термина/фразы из индекса. Поиск любого из 3 поисковых терминов не должен давать результатов поиска.

Удалите элемент содержимого: это удалит все использованные в элементе содержимого поисковые термины/фразы из индекса, за исключением случаев, когда эти поисковые термины/фразы все еще используются в других элементах содержимого.<sup>[\[1\]](#cite_note-1)</sup>

Удаленный элемент содержимого не должен появляться ни в одном списке результатов поиска.

## Изменения состояния элемента контента

Найдите необходимый элемент контента с помощью Умного Поиска. Затем выполните следующие тесты:

- Переместите элемент в корзину и повторите поиск. Элемент не должен больше появляться в результатах поиска.
- Опубликуйте элемент заново и повторите поиск. Элемент должен снова появляться в результатах поиска.
- Снимите публикацию элемента и повторите поиск. Элемент не должен больше появляться в результатах поиска.
- Архивируйте элемент и повторите поиск. Элемент должен снова появляться в результатах поиска.

## Изменения в карте контента (таксономии)

Хотя изменения в категории являются особым случаем изменений в карте контента, нам также необходимо протестировать изменения в ветвях карты контента, не относящихся к категории, потому что изменения категории задействуют иной код. Это не категорийные поля, которые подлежат картам контента в основных компонентах:

- Статьи
  - Автор
  - Категория
  - Язык
- Контакты
  - Категория
  - Страна
  - Язык
  - Регион
- Ленты новостей
  - Категория
  - Язык
- Веб-ссылки
  - Категория
  - Язык

Итак, выберите один (если один работает, они все будут работать для этого типа контента) из вышеупомянутых, который соответствует типу контента, и убедитесь, что:

- изменение поля приводит к появлению элемента в поиске с использованием
  соответствующего выпадающего списка (в расширенном поиске) для поля, которое вы изменили. <sup>[\[2\]](#cite_note-2)</sup>
- элемент контента не появляется в поиске с использованием старого значения
  поля.

Удалите элемент контента и проверьте, что он больше не отображается в результатах поиска с использованием соответствующего фильтра. Обратите внимание, что **не** ожидается, что неиспользуемый узел будет удален из соответствующего выпадающего фильтра. <sup>[\[3\]](#cite_note-3)</sup>

## Изменения состояния категории

Изменение состояния категории, к которой принадлежит элемент, должно обновлять индекс для этого элемента. Более того, изменение состояния родительской категории категории, к которой принадлежит элемент, также должно обновлять индекс для этого элемента. Чтобы протестировать, найдите или создайте элемент со следующей структурой:

    Категория A, содержащая Категорию A.1, содержащую элемент содержимого

Измените статус Категории A.1 и протестируйте следующим образом:

- Удалите Категорию A.1 и повторите поиск. Элемент больше не должен появляться в результатах поиска.
- Опубликуйте Категорию A.1 снова и повторите поиск. Элемент должен снова появиться в результатах поиска.
- Снимите публикацию Категории A.1 и повторите поиск. Элемент больше не должен появляться в результатах поиска.
- Архивируйте Категорию A.1 и повторите поиск. Элемент должен снова появиться в результатах поиска.

Восстановите Категорию A.1, затем измените статус Категории A и протестируйте следующим образом:

- Удалите Категорию A и повторите поиск. Элемент больше не должен появляться в результатах поиска.
- Опубликуйте Категорию A снова и повторите поиск. Элемент должен снова появиться в результатах поиска.
- Снимите публикацию Категории A и повторите поиск. Элемент больше не должен появляться в результатах поиска.
- Архивируйте Категорию A и повторите поиск. Элемент должен снова появиться в результатах поиска.

## Изменения уровня доступа элемента контента

Измените уровень доступа элемента контента на такой, который
пользователь интерфейса не должен видеть.

- проверьте, что элемент контента не появляется в списках результатов поиска.

Измените уровень доступа обратно на такой, который пользователь интерфейса
должен видеть.

- проверьте, что элемент контента теперь появляется в списках результатов поиска.

Обратите внимание, что поисковые термины внутри элемента контента все равно
будут появляться в списке автозаполнения, даже если у пользователя нет доступа
к самому элементу контента. Это ожидаемое поведение, хотя это может быть
вопросом, который стоит изучить. <sup>[\[4\]](#cite_note-4)</sup>

## Изменения уровня доступа к категории

Изменение уровня доступа к категории, к которой принадлежит элемент,
должно обновить индекс для этого элемента. Более того, изменение уровня
доступа родительской категории, к которой принадлежит элемент,
также должно обновить индекс для этого элемента. Чтобы протестировать, найдите
или создайте элемент со следующей структурой:

Категория A содержит Категорию А.1, которая содержит элемент контента

Проведите следующие тесты:

- Измените уровень доступа Категории А.1 на такой, при котором
  пользователь интерфейса не сможет его видеть.
  Проверьте, что элемент контента не появляется в списках результатов поиска.
- Измените уровень доступа Категории А.1 обратно на такой, чтобы
  пользователь интерфейса мог его видеть.
  Проверьте, что элемент контента теперь появляется в списках результатов поиска.
- Измените уровень доступа Категории A на такой, при котором 
  пользователь интерфейса не сможет его видеть.
  Проверьте, что элемент контента не появляется в списках результатов поиска.
- Измените уровень доступа Категории A обратно на такой, чтобы
  пользователь интерфейса мог его видеть.
  Проверьте, что элемент контента теперь появляется в списках результатов поиска.

## Изменения состояния умного поиска

На экране Администратор → Компоненты → Умный поиск → Карты контента
можно изменить состояние публикации/снятия с публикации ветвей и узлов карты контента. Следующие тесты должны быть выполнены:

- Снять с публикации ветвь карты контента (например, Автор).
  Проверьте, что выпадающий фильтр для этой ветви больше не отображается
  в расширенном поиске.
- Снять с публикации узел карты контента (в пределах опубликованной ветви). Например,
  "Животные" в ветви "Категория".
  Проверьте, что узел не отображается в выпадающем фильтре для ветви
  в расширенном поиске.

На экране Администратор → Компоненты → Умный поиск → Индексированный контент
выполните следующий тест:

- Снять с публикации элемент контента.
  Проверьте, что элемент контента больше не появляется в результатах поиска.

На экране Администратор → Расширения → Менеджер плагинов выполните
следующий тест:

- Установите фильтр "Выбрать тип" на "finder" или "умный поиск".
- Выберите один из плагинов типа контента и снимите его с публикации.
  Все данные для этого типа контента должны быть удалены из индекса.

Примечание: Если вы снова опубликуете плагин, он не добавит данные обратно в
индекс. Это ожидаемое поведение. Вам потребуется снова запустить
индексатор, чтобы вернуть данные.

