<!-- Filename: Setting_up_automatic_Smart_Search_indexing / Display title: Умная индексация поиска   -->

## Автоматическая индексация

Хотя индекс "Умного поиска" автоматически обновляется всякий раз, когда изменяются элементы контента, существуют обстоятельства, при которых необходимо повторно запустить индексатор. Вы можете сделать это вручную, используя кнопку "Индекс" на странице "Умный поиск: Индексированный контент". Однако, если вам нужно автоматически переиндексировать контент, это также можно сделать, запустив индексатор из командной строки. Это особенно удобно для запуска индексатора из задания *cron*.

Из каталога cli команда следующая:

```
php joomla.php finder:index
```

Типичный вывод индексатора из командной строки выглядит следующим образом:

    УМНЫЙ ПОИСК ИНДЕКСАТОР
    ============================

    Запуск индексатора
    Настройка плагинов Finder
    Настроено 154 элемента за 0.094 секунды.
     * Обработан пакет 1 за 0.213 секунды.
     * Обработан пакет 2 за 0.182 секунды.
     * Обработан пакет 3 за 0.177 секунды.
     * Обработан пакет 4 за 0.009 секунды.
    Общее время обработки: 0.676 секунды.

## Очистка перед индексированием

Обычно запуск индексатора выполняет инкрементное обновление индекса. То есть, он будет обновлять индекс только для тех элементов контента, которые изменились с момента последнего обновления индекса. Однако, если вам нужно полностью очистить все существующие записи индекса перед полным его восстановлением, тогда вам необходимо выполнить операцию "очистить, а затем индексировать". Для этого вы можете добавить аргумент `--purge` в командную строку, как показано ниже:

```php
php joomla.php finder:index --purge
```

Обратите внимание, что это попытается сохранить любые статические фильтры, которые вы могли установить, тогда как нажатие кнопки "Очистить" на панели инструментов в Администраторе **не** сохранит ваши статические фильтры.

## Настройка задания *cron*

Хотя подробности выходят за рамки данной статьи, в общем случае вам нужно будет просто ввести приведенную выше команду в менеджер задач *cron* и указать время или времена, в которые должно выполняться это задание. Вероятно, вам потребуется указать полный путь к индексатору. Например, так:

    php /var/www/myjoomla/cli/joomla.php finder:index -- purge

И, возможно, полный путь к файлу php, например, `/usr/local/opt/php@8.2/bin/php`.  

## Проблемы с нехваткой памяти

Если на вашем сайте имеются особенно сложные требования к индексированию, возможно, что стандартного объема выделенной памяти будет недостаточно для успешного завершения работы индексатора. Вы можете увеличить выделенную память для командного индексатора, добавив дополнительный параметр в командной строке, как показано ниже:

```bash
php -d memory_limit=256M joomla.php finder:index
```

Замените `256M` на значение, которое подходит для ваших обстоятельств.

Командный индексатор использует те же параметры, что и индексатор на странице Smart Search: Indexed Content. Вы можете изменить параметры, используя кнопку "Параметры" на этой странице. Обратите внимание, что как поле **Размер пакета индексатора**, так и поле **Ограничение таблицы памяти** влияют на объем памяти, используемой индексатором.

*Переведено с помощью openai.com*

