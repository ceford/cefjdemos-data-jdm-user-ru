<!-- Filename: https://magazine.joomla.org/all-issues/may-2022/joomla-new-http-headers-plugin-for-j4 / Display title: HTTP заголовки  -->

## Статья в журнале

Эта статья основана на статье из журнала сообщества Joomla! Брэндена Хеджеса в выпуске за май 2022 года.

Хотя статья написана для Joomla 4, содержание в равной степени относится и к Joomla 5.

## Новый плагин HTTP Headers в Joomla для J4

Продолжая тему безопасности, паролей и плагина WebAuthn Joomla, обсуждавшуюся в прошлом месяце, в этом месяце мы рассмотрим еще одну функцию безопасности Joomla, которая появилась вместе с J4. Это плагин HTTP Headers, который теперь включен в основные функции Joomla.

Интернет постоянно развивается, и Joomla никогда не отстает. Именно поэтому я выбираю его в качестве основной платформы для веб-разработки. Независимо от того, является ли ваш сайт небольшим семейным сайтом или полноценной платформой электронной коммерции с миллионами продаж, Joomla предлагает что-то для каждого и всегда стремится внедрять новые технологии. Некоторые разработки даже являются революционными.

> Введение плагина HTTP Headers в ядро Joomla 4 — это огромный шаг вперед в обеспечении безопасности вашего сайта от атак и вредоносной активности.

Этот системный плагин безопасности помогает владельцам сайтов легко настраивать заголовки HTTP безопасности из знакомой административной панели Joomla, вместо того чтобы ковыряться в файле htaccess или других файлах конфигурации. Или, что еще хуже, в панели управления хостинга.

Посмотрите, насколько сложно это настроить в Cpanel, и скажите, что вы не ошибетесь! И, это все, при условии, что как только фреймворк установлен в Apache и директории созданы, вы знаете правильный формат для добавления HTTP-заголовков, которые вы хотите интегрировать.

Сколько раз вы пытались внедрить команду htaccess, чтобы затем перезагрузить сайт и столкнуться с ошибкой http500?

Самая большая проблема в том, что если вы неправильно зададите формат вашего HTTP-заголовка, вы сломаете свой сайт.

Даже тогда, то, что работает для одного сайта, может не сработать для другого. Хороший пример этого — мой файл htaccess и способ, которым я настраиваю загрузку браузером не-www https версии моего сайта:
```
##www в не-www и http в https
RewriteCond %{HTTPS} off [OR]
RewriteCond %{HTTP_HOST} ^www\. [NC]
RewriteRule ^ https://mywebsite.co.uk%{REQUEST_URI} [R=301,L,NE]
##Конец www в не-www и http в https
```

Это отлично работало на моем предыдущем хостинге. Но когда я переключился на другой хостинг, это перестало работать. Загадка!

Код htaccess, который я теперь должен использовать для достижения того же результата, выглядит так:
```
##www в не-www и http в https
RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
RewriteRule ^(.*)$ https://%1/$1 [R=301,L]
RewriteCond %{ENV:HTTPS} !on
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
##Конец www в не-www и http в https
```

Запутанно, правда? И, если допустите одну ошибку в форматировании, БАХ! Ваш сайт сломан! Ну, по крайней мере, до тех пор, пока вы не исправите свой код.

Поэтому, сохранение простой интеграции, как части core Joomla, означает меньше разочарования, меньше потраченного впустую времени на поиски ваших ошибок в Google и больше времени для празднования, когда вы сидите в своем кресле и восхищаетесь вашим новым сайтом.

Итак, давайте посмотрим, что такое HTTP-заголовки, как найти плагин и что вы можете с ними сделать. Стоит отметить здесь, что эта функция Joomla больше подходит для сайтов с чувствительными данными, чем для нового сайта, который вы с любовью создали о своих милых котятах. Однако, с учетом сказанного, даже простые сайты должны быть максимально защищены, чтобы предотвратить исполнение вредоносного кода после взлома вашего сайта.

## Что такое HTTP заголовки?

HTTP заголовки не следует путать с разделом &lt;head&gt; в вашем HTML документе. Это абсолютно разные вещи. HTTP заголовки — это предисловие между вашим веб-сервером и браузером. Это набор инструкций, которые сообщают браузеру, что, или более важно, что не показывать посетителю.

Вы можете увидеть HTTP заголовки и то, как они связаны с отдельными HTML-объектами в инструментах разработчика вашего браузера. В Google Chrome откройте инструменты разработчика, затем вкладку "Сеть" (Network). Теперь обновите веб-страницу и нажмите на HTML элемент в левой панели. HTTP заголовок для этого элемента будет отображен в правой панели.

На изображении ниже видно, что выделенное изображение возвращает статус HTTP 200, что означает, что браузер его нашел. Также имеется ряд другой информации, связанной с этим элементом, такой как размер файла и даты редактирования.

![Joomla http headers 1](../../../en/images/security/http-headers-dev-tools-headers.png)

Если один из ваших HTML элементов не удается отобразить, вы также можете получить подсказку о причине в HTTP заголовках. В этом примере второе изображение не удалось отобразить, и вы можете увидеть по информации, отображаемой в правой панели, что отсутствует информация об HTTP заголовках.

Кроме загадочного сообщения:

**Политика реферера:** 'strict-origin-when-cross-origin'

'Строгий источник, когда кросс-оригин' просто означает, что когда HTML элемент (в данном случае изображение) подается из другого источника (не вашего сервера), должна соблюдаться политика HTTP-заголовка, установленная в тот момент. В этом примере HTTP заголовки, установленные в плагине Joomla, отклонят все изображения, которые не происходят либо с этого сайта, либо с другого сайта, который специально 'включен' в параметры HTTP заголовков, установленных в плагине HTTP заголовков Joomla.

Итак, когда изображение вызывается из HTML документа, браузер его отклоняет, и оно не загружается.

![Joomla http headers 2](../../../en/images/security/http-headers-dev-tools-headers-reject.png)

Что отличается от ситуации, когда объект не найден и возвращает ошибку 404 не найдено (404 not found HTTP error message). В этом случае изображение все еще ищется на сервере, который его размещает, но браузер его не нашел.

![Joomla http headers 3](../../../en/images/security/http-headers-dev-tools-headers-not-found.png)

## Что делает плагин Joomla HTTP Headers

Помимо указания браузеру, что отображать, и предоставления общей информации о HTML-документе, HTTP-заголовки помогают смягчить атаки и уязвимости в безопасности, которые могут быть на вашем Joomla сайте. Именно здесь плагин Joomla HTTP Headers проявляет свою полезность. Он достигает этого, явно отображая HTML-контент в соответствии с вашими настройками в самом плагине Joomla HTTP Headers.

Добавляя дополнительные защитные HTTP-заголовки на ваш сайт Joomla с помощью плагина HTTP Header, вы обеспечите еще один уровень безопасности для вашего Joomla сайта.

Это важно, поскольку по умолчанию HTML-страница будет отображать весь свой контент вашему посетителю, хороший или плохой. Если только в HTTP-заголовках веб-страницы не указано явно, что этого делать не следует. Плагин позволяет вам настроить доступные расширенные параметры безопасности в Content-Security-Policy для вашего сайта. Плагин может быть настроен по-разному для каждого сайта в зависимости от ваших требований, так что это действительно гибкое оружие в вашем арсенале против хакеров.

## Зачем мне нужен этот плагин?

В идеальном мире он бы вам не понадобился. Однако в мире, в котором мы живем, слишком много недобросовестных людей, пытающихся заработать деньги на невинных и ничего не подозревающих людям. В нашем мире мы называем этих людей хакерами. Хакеры изо всех сил стараются воспользоваться уязвимостями программного обеспечения ради получения финансовой выгоды, что часто наносит ущерб владельцу сайта.

Используя плагин HTTP Header для Joomla, чтобы контролировать, какой контент предоставляется вашим посетителям, вы снижаете вероятность того, что хакеры смогут передать вашим посетителям вредоносный контент вашего сайта через устаревшие уязвимые плагины. Это помогает остановить внедрение вредоносных скриптов на вашем сайте.

**Итак, давайте на минуту представим эту гипотетическую ситуацию.**

У вас есть хороший сайт на Joomla 3. Он был создан 5 лет назад и до сих пор выглядит и работает идеально. Все ваши компоненты, плагины и модули обновлены. Отлично, правда?

Ну, не совсем, потому что, когда вы создавали свой сайт 5 лет назад, вы установили модный плагин Foo Bar, чтобы печатать "FOO BAR" на главной странице. Сначала это выглядело круто, но через некоторое время вы передумали и удалили шорткод плагина {foo}FOO - BAR{/bar} из статьи на вашей главной странице.

Но вот проблема: вы не сняли плагин с публикации и не удалили его, и его использование улетучилось из памяти. **Уверен, мы все в этом виноваты.**

Переходя к сегодняшнему дню, спустя 5 лет, этот плагин все еще находится на вашем сайте, опубликован и активен, но его не обновляли 5 лет, потому что вы давно забыли о плагине или его автор перестал его поддерживать. Теперь какой-то зловредный человек понял, что в этом плагине есть уязвимость, которую можно использовать, чтобы начать **атаку межсайтового скриптинга (XSS)** на вашем сайте и сделать ваших ничего не подозревающих посетителей жертвами.

Межсайтовый скриптинг, известный также как XSS, это уязвимость безопасности на вашем сайте, которая позволяет атакующему скомпрометировать взаимодействия ваших пользователей с вашим теперь уже уязвимым сайтом.

Атакующий/хакер использует XSS для эксплуатации вашего уязвимого сайта, чтобы отправить вредоносный скрипт вашему ничего не подозревающему пользователю. Поскольку скрипт исходит с вашего сайта, браузер вашего пользователя не знает или не подозревает, что скрипту не следует доверять, и выполняет его при загрузке и открытии веб-страницы.

Вредоносные скрипты, выполняемые таким образом, могут вызвать множество проблем для вашего пользователя, от кражи паролей и логинов, хранящихся в cookies, до перенаправления пользователя на фальшивые фишинговые сайты. Скрипты могут даже изменить внешний вид веб-страницы, которую обслуживает ваш сайт, и показать вам различную рекламу.

Использование **плагина HTTP Headers для Joomla** помогает остановить межсайтовый скриптинг, обеспечивая, что только те скрипты и контент, которые вы хотите предоставить вашему посетителю, на самом деле обслуживаются. Все остальное блокируется.

Таким образом, в приведенном выше примере вы могли бы настроить плагин HTTP Headers так, чтобы обслуживать JavaScript файлы вашего сайта только из указанной папки, или, если вы используете CDN, чтобы остановить атаку.

Вы также могли бы предотвратить запуск встроенного JavaScript, встроенного в HTML. Однако имейте в виду, что в зависимости от того, как вы разработали ваш HTML, это может вызвать проблемы в будущем.

Это помогло бы предотвратить выполнение вредоносного JavaScript-кода на вашем сайте. Даже если виновником уязвимости был ваш плагин Foo Bar, позволивший хакеру изначально внедрить вредоносный код на ваш сайт.

**Примечание:**

> Общие слабые места на сайтах, склонных к атакам XSS, это формы ввода данных пользователем (страницы входа в систему, формы подписки на новостную рассылку, формы обратной связи и т.д.) без проверки и шифрования.

## Где находится плагин HTTP Headers?

Вы можете найти плагин HTTP Headers для Joomla вместе со всеми другими плагинами Joomla, и доступ к нему осуществляется точно так же, как вы привыкли это делать.

![Joomla http headers 4](../../../en/images/security/http-headers-plugins.png)

## Использование плагина HTTP Headers

Использование плагина HTTP в Joomla довольно простое, хотя перед изменением настроек по умолчанию может быть полезно изучить некоторые специальные термины, связанные с его использованием. Хотя многие из них вам уже должны быть знакомы.

**Например:**

При работе с изображениями вы увидите термин 'img-src', где 'img' относится к изображениям, а 'src' — к допустимому источнику изображения. Эти термины нам уже знакомы из основного HTML.

В конце этой статьи приводится список полезных веб-сайтов с дополнительной информацией, чтобы помочь вам использовать этот плагин Joomla.

