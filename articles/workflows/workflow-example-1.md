<!-- Filename: J6.x:Workflow_Scenarios_Example_1 / Display title: Пример рабочего процесса 1  -->

## Введение

Рабочий процесс состоит из *этапов* и *переходов* между этими этапами. Для любой статьи записывается текущий этап, который сохраняется в базе данных и используется для идентификации рабочего процесса и переходов, используемых этим процессом.

Один сайт может иметь множество рабочих процессов. Здесь, в качестве примера, используется *Рабочий процесс рассылки*, чтобы объяснить, как три человека с разными ролями могут участвовать в подготовке статьи для рассылки. В примере используются стандартные группы пользователей Joomla: Автор, Редактор и Издатель. Это создает проблему: Автор может видеть только опубликованные статьи и не может заново редактировать неопубликованные статьи. Способ избежать этой проблемы рассмотрен в [Примере 2](jdocmanual?article=user/workflows/workflow-example-2).

![Список рабочих процессов](../../../en/images/workflows/example-1-workflows-list.png)

Обратите внимание, что *Базовый рабочий процесс* установлен по умолчанию (*Default*). Это может иметь неприятные последствия, которые будут описаны позже в этой статье!

## Пользователи

- *Артур* — пользователь, назначенный в **группу авторов** Joomla. Он может создавать новые статьи и редактировать собственные статьи, но не может редактировать статьи, написанные другими пользователями, или изменять состояние статей. Таким образом, он не может публиковать свои статьи. Его задача — писать черновики новых статей.
- *Эдди* — пользователь, назначенный в **группу редакторов** Joomla. Он может редактировать статьи, созданные любым другим пользователем, включая Артура и самого себя. Он также не может изменять состояние статьи. Его работа заключается в просмотре статей, поданных Эдди, проверке их на точность, орфографию и грамматику, качество изображений и так далее.
- *Пру* — пользователь, назначенный в **группу издателей** Joomla. Она может делать все, что могут делать Эдди и Артур. Кроме того, она может изменять состояние статьи. Ее задача — решать, приемлема ли статья для публикации, и публиковать ее.

## Этапы

В этом рабочем процессе выделяются четыре этапа:

![Список рабочих процессов](../../../en/images/workflows/example-1-workflow-stages.png)

- **Черновик** — это этап, создаваемый Артуром для новой статьи.
- **Рецензия** — это этап, на котором Эдди берет на себя проверку материала.
- **Одобрение** — это этап, на котором Пру решает, достаточно ли хороша статья для публикации.
- **Публикация** — это этап, когда статья одобрена и опубликована.

Для форм ввода данных о стадиях требуется лишь немного объяснений — только Имя и Описание.

## Переходы

Для каждого этапа требуется два перехода: один — чтобы вернуться к предыдущему этапу, если требуется больше работы; и второй — чтобы перейти к следующему этапу. Дополнительные переходы требуются для обработки удаления статьи:

![Список рабочих процессов](../../../en/images/workflows/example-1-workflow-transitions.png)

- **Черновик/Рецензия** для перехода от состояния Черновик к Рецензия.
- **Рецензия/Черновик** чтобы вернуться от состояния Рецензия к Черновик.
- **Рецензия/Одобрение** для перехода от Одобрения к Рецензия.
- **Одобрение/Рецензия** чтобы вернуться от Одобрения к Рецензия.
- **Рецензия/Публикация** для перехода к опубликовывему состоянию и изменения статуса статьи на *Опубликовано*.
- **Публикация** для установки состояния статьи *Опубликовано*, когда переход выполняется автором или редактором.
- **Снять с публикации** для изменения статуса статьи на *Неопубликовано*.
- **Архивировать** для изменения статуса статьи на *Архивировано*.
- **Удалить** для изменения статуса статьи на *Удалено*.

Последние три перехода позволяют Пру изменить статус статьи, когда она больше не требуется.

### Изменение Перехода

Форма ввода данных имеет четыре вкладки, начиная с вкладки *Переход*:

![Список рабочих процессов](../../../en/images/workflows/example-1-edit-transition.png)

- **Имя** Лучше всего использовать текущие и целевые этапы в названии.
- **Текущий Этап** Этап перед тем, как произойдет переход.
- **Целевой Этап** Этап после того, как переход произошел.
- **Заметка** Любые пояснительные заметки, чтобы объяснить переход.

#### Вкладка *Действия перехода*:

![Список рабочих процессов](../../../en/images/workflows/example-1-edit-transition-actions.png)

- **Состояние Ведьмна** Определите состояние предмета после выполнения этого перехода. Оставьте это на *-Не выбрано-*, если пользователь, вероятно, не имеет разрешения отмечать статьи.
- **Состояние Публикации** Определите состояние публикации предмета после выполнения этого перехода. Оставьте это на *-Не выбрано-*, если пользователь, вероятно, не имеет разрешения изменять состояние статьи.

#### Вкладка *Уведомления*:

![Список рабочих процессов](../../../en/images/workflows/example-1-edit-transition-notification.png)

- **Отправить Уведомление** Установите значение *Да*, если уведомления необходимы, например, когда Артуру нужно уведомить Эдди, что статья готова к рецензии.
- **Дополнительный текст сообщения** Это общий дополнительный текст, чтобы помочь получателю.
- **Группы пользователей** Вы можете выбрать отправку уведомления одной или нескольким группам пользователей или отправить уведомление отдельным пользователям.
- **Пользователи** Выберите отдельных пользователей из списка пользователей.

#### Вкладка *Разрешения*:

Обратите внимание, что у *Автор* установлено *Выполнить переход* в Разрешено (унаследовано). Не изменяйте эти настройки для других переходов, которые автор не должен использовать, так как это также повлияет на редакторов и издателей.

## Категория статьи

Каждая статья назначается определенному рабочему процессу при первом сохранении. Если статья сначала назначается категории, для которой выбран рабочий процесс, она назначается этому рабочему процессу. В противном случае она назначается к рабочему процессу по умолчанию. Это может быть проблематично, поскольку компонент рабочего процесса не предусматривает метод изменения рабочего процесса после его назначения. Изменения может выполнить суперпользователь, используя групповое действие на странице списка статей.

### Создание категории для информационного бюллетеня

Необходима новая категория для информационного бюллетеня, чтобы показывать его в виде блога категории и чтобы статьи информационного бюллетеня назначались рабочему процессу информационного бюллетеня.

![Список рабочих процессов](../../../en/images/workflows/example-1-newsletter-category.png)

## Пункт меню для новостной рассылки

Чтобы посетители сайта могли видеть новостную рассылку, она должна быть на главной странице или связана с пунктом меню. Для этого примера создайте новый пункт меню типа *Блог категории* с использованием категории *Новостная рассылка*.

Попробуйте пункт меню сайта. Скорее всего, это будет пустая страница с таким сообщением:

<div class="alert alert-info">
В этой категории нет статей. Если на этой странице отображаются подкатегории, они могут содержать статьи.
</div>

## Войти как Артур

Помните Артура - Автора? После входа на страницу новостей должна быть
кнопка с надписью **Новая статья**. Выберите её, чтобы написать новую статью.

### Написать статью

Заполните форму редактирования статьи так же, как вы бы сделали для любой другой статьи. Однако, перед первым сохранением посмотрите на вкладку *Публикация*.

- **Этап рабочего процесса** должен быть установлен на **Запуск перехода** *Черновик/Обзор*.
- **Категория** должна быть установлена на *Новости*.

Когда вы закончите редактирование статьи, выберите *Сохранить* или *Сохранить и закрыть*.

<div class="alert alert-danger">После закрытия статьи Артур не сможет её отредактировать снова, потому что пользователи в группе Автор не могут просматривать неопубликованные статьи.</div>

## Войти как Эдди

У Эдди Редактора есть разрешение на просмотр неопубликованных статей, поэтому на странице "Новостная рассылка" отображаются любые неопубликованные материалы, которые он может редактировать.

### Проверка статьи

Выберите статью, которую подготовил Эдди, и внесите любые изменения, необходимые для её улучшения. Когда вы будете довольны, в *вкладке Публикации*:

- **Этап рабочего процесса** должен быть установлен на **Перевод этапа** *Проверка/Утверждение*.

В отличие от Артура, который не может видеть свою статью после сохранения, Эдди может снова её видеть и редактировать. Он также может установить переход на следующий этап для утверждения/публикации. Переход будет работать, но статья не будет опубликована, так как у Эдди нет прав на публикацию.

## Войти как Пру

Когда на этапе Одобрения был установлен этап рабочего процесса, Пру должна была получить сообщение с запросом на действие. Поэтому войдите как Пру, чтобы просмотреть статью и установить её этап рабочего процесса на **Запустить переход** *Опубликовать*. *Сохранить и Закрыть* статью, чтобы увидеть опубликованный результат. Выйдите из системы, чтобы увидеть результат без ссылки Редактировать.

Мысль после: необходим еще один этап, чтобы позволить Пру вернуть этап из Опубликовать в Отзыв, если она хочет, чтобы Эдди что-то исправил.

## Рабочий процесс на серверной части

Группы пользователей «Автор», «Редактор» и «Издатель» предназначены для использования на клиентской стороне. Проблема Артура в том, что он не может получить доступ к своим черновикам статей с клиентской стороны, потому что его группа пользователей не имеет прав на просмотр неопубликованных статей.

Вы можете предоставить доступ к серверной части для всех участников этих групп следующим образом:

- Перейдите на страницу **Глобальная конфигурация**.
- Выберите вкладку **Разрешения**.
- Выберите *Автор* и установите **Вход администратора** на *Разрешено*.
- **Сохранить**
- Перейдите на страницу **Статьи: Параметры**.
- Выберите её вкладку **Разрешения**.
- Выберите *Автор* и установите **Доступ к интерфейсу администратора** на *Разрешено*.

Это позволит Артуру, Эдди и Пру войти в серверную часть с доступом к элементам контента. Значительно сокращенная главная панель управления:

![Главная панель для Артура](../../../en/images/workflows/example-1-backend-home.png)

Но Артур имеет доступ к своим черновикам статей:

![Список статей для Артура](../../../en/images/workflows/example-1-backend-articles.png)

Обратите внимание, что Артур не может редактировать последний элемент в списке, потому что это не его собственная статья. Название статьи не связано с ссылкой. Аналогично, Артур не может редактировать существующие категории, потому что у него нет разрешения и они также не связаны с ссылками. Он может создать новую категорию, но она не опубликована, и он не может её опубликовать!

## Исправление неверного рабочего процесса

Если вы назначили статью неверному рабочему процессу, есть два метода, чтобы исправить проблему.

### Метод суперпользователя

- Перейдите к списку **Статей**.
- Установите флажок для проблемной статьи.
- Выберите кнопку **Действия** на панели инструментов.
- Выберите кнопку **Пакетная обработка** из списка.
- В диалоге *Пакетная обработка выбранных статей* выберите **Изменить этап**.
- Выберите соответствующий целевой рабочий процесс и этап.
- Нажмите кнопку **Обработать**.

![Список статей для Артура](../../../en/images/workflows/example-1-backend-batch.png)

### Резервный метод

В качестве альтернативы можно отредактировать таблицу базы данных с помощью phpMyAdmin или аналогичного инструмента.

Необходимая информация:

- ID статьи из последнего столбца в списке статей.
- ID этапа в нужном рабочем процессе из последнего столбца списка этапов рабочего процесса, который вы хотите использовать.

В phpMyAdmin:

- Просмотрите таблицу #__workflow_associations, чтобы найти элемент с item_id, который содержит ID вашей статьи.
- Измените значение stage_id на ID этапа, который вы нашли в нужном рабочем процессе.

Вернитесь к списку ваших статей и убедитесь, что проблемная статья теперь использует правильный рабочий процесс.

*Переведено с openai.com*

