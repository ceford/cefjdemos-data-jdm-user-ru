<!-- Filename: jdocmanual?manual=user&heading=help&filename=administrator-help.md / Display title: Справка для администратора   -->

## Введение

Почти на всех страницах администратора Joomla есть Панель инструментов, содержащая кнопку **Справка** в правом верхнем углу страницы. Только на Панелях управления отсутствует Панель инструментов и, следовательно, кнопка Справка.

На многих страницах также имеется кнопка с надписью **Переключить встроенную справку**. Она просто отображает или скрывает описание поля, если оно доступно. Ее цель — уменьшить загромождение, но предоставить механизм напоминания, если это будет полезно. Здесь она не рассматривается далее.

Кнопка **Справка** вызывает открытие нового окна с помощью URL, встроенного в кнопку. Пример: 
```
data-url="https://help.joomla.org/proxy/index.php?keyref=Help51:Articles&lang=en"
```
В этом случае содержание страницы Справки поступает из внешнего источника.

## Источник помощи - сайт MediaWiki

MediaWiki — это программное обеспечение, используемое Википедией. Это пакет свободного программного обеспечения с открытым исходным кодом (FOSS), который использует PHP и MySQL, так же как и Joomla. Вы можете скачать и установить его самостоятельно. Теоретически, вы могли бы создать свой собственный сервер помощи и использовать его вместо общего сервера помощи Joomla. На практике, вам нужно знать, что страницы MediaWiki требуют некоторой обработки, чтобы они подходили для отображения в качестве страниц помощи.

И вот здесь появляется **прокси**. Он получает необходимую страницу из установки MediaWiki и подготавливает её для отображения в качестве страницы помощи. Вы можете увидеть оригинальную страницу MediaWiki в этом примере по ссылке https://docs.joomla.org/Help5.x:Articles и отредактировать её, если заметите что-то неправильное.

## Глобальный URL справки

Файл **configuration.php** в корневой директории установки Joomla содержит переменную `$helpurl`:

```
$helpurl = 'https://help.joomla.org/proxy/index.php?keyref=Help{major}{minor}:{keyref}&lang={langcode}';
```

Когда нажата кнопка помощи, каждый из элементов в фигурных скобках заменяется. Значения {major} и {minor} соответствуют версиям вашей установки. Значение {langcode} – это код выбранного в данный момент языка Администратора, который может быть en, de или fr.

Переменная {keyref} – это имя файла страницы на сервере помощи, за исключением его пространства имен. Таким образом, для страницы "Статьи" соответствующее имя файла – *Articles*.

**Примечание:** `https://docs.joomla.org/` – сайт для редактирования страниц помощи. А `https://help.joomla.org/proxy` – это сайт для получения страниц помощи.

Нет возможности изменить URL сервера помощи по умолчанию из форм Глобальной конфигурации Администратора, но вы можете изменить его с помощью текстового редактора.

Полный список доступных кодов замены:

| Код           | Будет замещён на                                                    |
|---------------|---------------------------------------------------------------------|
| {app}         | Имя приложения (например, "Administrator" в интерфейсе Joomla CMS)  |
| {component}   | Имя компонента (например, "com_content" в Менеджере Статей)         |
| {keyref}      | Ключ ссылки на экран помощи (после прохождения через систему перевода)|
| {major}       | Номер основной версии Joomla (например, "5" в Joomla 5.6)           |
| {minor}       | Номер минорной версии Joomla (например, "1" в Joomla 5.1)           |
| {maintenance} | Номер версии обслуживания Joomla (например, "3" в Joomla 5.1.1)     |
| {language}    | Полный код языка (например, "en-GB")                                |
| {langcode}    | Часть кода языка (например, "en", если полный код – "en-GB")        |
| {langregion}  | Часть кода региона (например, "GB", если полный код – "en-GB")      |

## Глобальная поддержка в будущем

Использование сайта MediaWiki для предоставления страниц помощи является некоторой нагрузкой для тех, кто поддерживает документацию. В будущем процедура может измениться. Если изменения произойдут, вероятно, источником будут заранее подготовленные HTML-файлы, доступ к которым будет осуществляться с простым изменением домена источника $helpurl.

## Локальная помощь для пользовательского компонента

Если у вас есть пользовательский компонент и вы уверенно редактируете PHP-код и создаете контент, вы можете создать собственные страницы помощи. Рассмотрим в качестве примера компонент Jdocmanual. Будучи пользовательским компонентом, у него нет страниц помощи на сайте MediaWiki по адресу docs.joomla.org. Компонентам третьих сторон не разрешается размещать страницы помощи там.

Обратите внимание на этот фрагмент кода из administrator/components/com_jdocmanual/src/View/Manual/ViewHtml.php:
```php
        $tmpl = $app->input->getCmd('tmpl');
        if ($tmpl !== 'component') {
            ToolbarHelper::help('jdocmanual', true);
        }
```
Спецификация вызова ToolbarHelper::help следующая:
```php
@param $ref: Имя целевого файла (без расширения файла).
@param $useComponent: Использовать файл помощи в папке компонента.
@param $url: Использовать этот URL вместо любого другого.
@param $component: Имя компонента для получения помощи (null для текущего компонента)
function Toolbar::help(
    string $ref,
    bool $useComponent = false,
    string $url = null,
    string $component = null
): HelpButton
Записывает кнопку помощи для данной опции (открывает всплывающее окно).
```
В этом примере **$ref** — это имя файла, в данном случае `'jdocmanual'` (оно должно соответствовать регистру целевого файла), а **$useComponent** — это `true`, что означает, что страница помощи будет находиться в файлах компонента по адресу administrator/component/com_jdocmanual/help/en-GB/jdocmanual.html.

Использование файла помощи внутри компонента должно означать, что помощи никогда не будет не хватать, и, возможно, она всегда будет актуальной.

## Удаленная помощь с пользовательским компонентом

При создании кнопки помощи вы можете установить $useComponent = false и задать URL, чтобы он указывал на определенное местоположение на вашем сайте или на удаленный сайт.

```
    ToolbarHelper::help('jdocmanual', false, 'http://example.com/help/en-GB/jdocmanual.html');
```

Таким образом, все, что необходимо, это HTML-страница с правильным именем в правильном месте.

*Переведено openai.com*

